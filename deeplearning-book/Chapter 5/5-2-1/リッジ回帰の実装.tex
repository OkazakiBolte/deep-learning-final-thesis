%\documentclass{jsarticle}
%\documentclass[draft]
%\documentclass[dvipdfmx,autodetect-engine,draft]{jsarticle}% autodetect-engine ã§ pLaTeX / upLaTeX ã‚’è‡ªå‹•åˆ¤å®š
\documentclass[dvipdfmx,autodetect-engine]{jsarticle}% autodetect-engine ã§ pLaTeX / upLaTeX ã‚’è‡ªå‹•åˆ¤å®š

\usepackage[dvipdfmx]{graphicx}
\usepackage{url}
\usepackage{bm}
\usepackage{comment}
%\usepackage{split}
\usepackage{multirow}
\usepackage{listings,jlisting}
\usepackage{braket}
\usepackage{physics}
\usepackage{xparse,amsmath}
\usepackage{here}
\usepackage{enumerate}
\usepackage{mathrsfs}
%\usepackage{jlistings} %æ—¥æœ¬èªã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’ã™ã‚‹å ´åˆjlistingãŒå¿…è¦
\setcounter{tocdepth}{3}
\usepackage{amsmath,amssymb}

\usepackage{empheq}



%ã“ã“ã‹ã‚‰ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®è¡¨ç¤ºã«é–¢ã™ã‚‹è¨­å®š
\lstset{
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\smallitshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  stepnumber=1,
  numbersep=1zw,
  lineskip=-0.5ex
}
\renewcommand{\lstlistingname}{ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰}
%ã“ã“ã¾ã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®è¡¨ç¤ºã«é–¢ã™ã‚‹è¨­å®š

%
% proof environment without \qed
%
\makeatletter
%\renewenvironment{proof}[1][\proofname]{\par
\newenvironment{Proof}[1][\Proofname]{\par
  \normalfont
  \topsep6\p@\@plus6\p@ \trivlist
  \item[\hskip\labelsep{\bfseries #1}\@addpunct{\bfseries.}]\ignorespaces
}{%
  \endtrivlist
}
%\renewcommand{\proofname}{è¨¼æ˜}
%\renewcommand{\proofname}{Proof}
\newcommand{\Proofname}{è¨¼æ˜}
%\newcommand{\Proofname}{Proof}
\makeatother
%
% \qed
%
\makeatletter
\def\BOXSYMBOL{\RIfM@\bgroup\else$\bgroup\aftergroup$\fi
  \vcenter{\hrule\hbox{\vrule height.85em\kern.6em\vrule}\hrule}\egroup}
\makeatother
\newcommand{\BOX}{%
  \ifmmode\else\leavevmode\unskip\penalty9999\hbox{}\nobreak\hfill\fi
  \quad\hbox{\BOXSYMBOL}}
%\renewcommand\qed{\BOX}
\newcommand\QED{\BOX}



\begin{document}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


%åˆ†æ•°
\newcommand{\f}[2]{\frac{#1}{#2}}
%åå¾®åˆ†ãƒ‰(partial defferential)
\newcommand{\pd}[2]{\frac{\partial #1}{\partial#2}}
%å¾®åˆ†
\newcommand{\D}[2]{\frac{ \mathrm{d} #1}{\mathrm{d}#2}}
%ã‹ã‘ã‚‹10ã®ãªã‚“ã¨ã‹ä¹—
\newcommand{\E}[1]{ \times 10^{#1}}
%æ•°å¼ä¸­ã®å˜ä½ï¼ˆç©ºç™½ä»˜ãï¼‰
\newcommand{\un}[1]{~{\rm #1}}
%ç«‹ä½“ã®æ·»ãˆå­—
\newcommand{\sub}[2]{#1_{\rm #2}}
%ç«‹ä½“
\newcommand{\R}[1]{{\rm #1}}
%ã‹ã‘ã‚‹Ã—
\def\*{\times}
%displaystyle
\newcommand{\dps}[1]{\displaystyle{#1}}
%ref
\newcommand{\rf}[1]{\ref{#1}}
%label
\newcommand{\lb}[1]{\label{#1}}
%\begin{equation}
\def\be{\begin{equation}}
%\end{equation}
\def\ee{\end{equation}}
%æ•°å¼å†…ã®æ—¥æœ¬èª
\newcommand{\jp}[1]{\mbox{#1}}
%ã‚¤ã‚³ãƒ¼ãƒ«ã‚’æƒãˆã‚‹æ™‚ã®å‘ªæ–‡
\def\bea{\begin{eqnarray}}
\def\eea{\end{eqnarray}}
%å¼ç•ªå·ã‚’ã¤ã‘ãŸããªã„ã¨ãã«ã¯
\def\bea*{\begin{eqnarray*}}
\def\eea*{\end{eqnarray*}}
%ã‚¤ãƒ³ãƒ†ã‚°ãƒ©ãƒ«
\newcommand{\I}[4]{\int_{#1}^{#2} \, #3 \, {\rm d} #4}
%ãƒ¬ãƒ•ãƒˆãƒ»ãƒ©ã‚¤ãƒˆ
\def\l{\left}
\def\r{\right}
%ãƒ™ã‚¯ãƒˆãƒ«ã®å¤ªæ–‡å­— with \usepackage{bm}
%\newcommand{\vct}[1]{\bm{#1}}
%ã‚°ãƒ©ãƒ‡ã‚£ã‚¨ãƒ³ãƒˆ
%\newcommand{\grad}[1]{{\rm grad}\, #1}
%ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
%\newcommand{\Div}[1]{{\rm div}\, #1}
%ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
%\newcommand{\rot}[1]{{\rm rot}\, #1}
%åˆ†æ•£
%\def\var{{\rm var}}
%å…±åˆ†æ•£
%\def\Cov{{\rm Cov}}
%å¹³å‡ã®ã‹ã£ã“

\def\T{\mathsf{T}}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



\begin{flushright}
è¼ªè¡Œäºˆå®šæ—¥ï¼š2019å¹´10æœˆ28æ—¥
\\æ…¶æ‡‰ç¾©å¡¾å¤§å­¦ç†å·¥å­¦éƒ¨ç‰©ç†å­¦ç§‘\\å²¡å´å¥äºº
\end{flushright}
\begin{center}
{\Large Ridgeå›å¸°ã®å®Ÿè£…} 
\end{center}
%ç®‡æ¡æ›¸ã
%\tableofcontents   %ğŸ‘ˆç›®æ¬¡
%\newpage


æ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿$\lambda$ã®å€¤ã«ã‚ˆã£ã¦æ¨å®šã•ã‚Œã‚‹æ›²ç·šãŒã©ã®ã‚ˆã†ã«å¤‰ã‚ã‚‹ã®ã‹ã€Fortran90ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ„ã‚“ã§å®Ÿé¨“ã—ãŸã€‚ã“ã“ã§ã¯æ­£å‰‡åŒ–é …ã‚’$\lambda \norm{\vb*{w}}_2^2$ã¨ã—ãŸï¼ˆRidgeå›å¸°ï¼‰ã€‚

\section{æ­£å‰‡åŒ–æœ€å°äºŒä¹—æ³•ï¼ˆRidgeå›å¸°ï¼‰}
ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’$(x_i,y_i)_{i=1,\ldots,m}$ã¨ä¸ãˆã‚‹ã€‚ã“ã‚Œã‚’$n$æ¬¡é–¢æ•°$\hat{y}=w_0+w_1 x + w_2 x^2 + \cdots + w_{n} x^{n}=\displaystyle\sum_{k=0}^{n} w_k x^{k}$ã§è¿‘ä¼¼ã™ã‚‹ã€‚$x$ã®æ¬¡æ•°é †ã«ä¸¦ã¹ãŸãƒ™ã‚¯ãƒˆãƒ«ã‚’$\vb*{x}=\qty[1,x,x^2,\ldots,x^{n}]^\mathsf{T},~$ä¿‚æ•°ã‚’ä¸¦ã¹ãŸãƒ™ã‚¯ãƒˆãƒ«ã‚’$\vb*{w}=\qty[w_0,w_1,\ldots,w_{n}]^\mathsf{T}$ã¨ã™ã‚Œã°ï¼ˆã“ã‚Œã‚‰ã¯$n+1$æ¬¡ã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«ï¼‰ã€ã“ã®é–¢æ•°ã¯$\hat{y}=\vb*{w}^\mathsf{T} \vb*{x}$ã¨ãªã‚‹ã€‚å„ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿$(x_i,y_i)$ã‚’ä½¿ã£ã¦å˜ç´”ã«ã“ã®$n$æ¬¡å¤šé …å¼ã‚’è¨ˆç®—ã—ãŸ$\hat{y}_i=\displaystyle\sum_{k=0}^{n} w_k x_{i}^{k}$ã‚’ä¸¦ã¹ãŸ$m$æ¬¡åˆ—ãƒ™ã‚¯ãƒˆãƒ«ã‚’$\hat{\vb*{y}}=\qty[\hat{y}_1,\ldots,\hat{y}_m]^\mathsf{T}$ã¨ã™ã‚‹ã€‚ã“ã‚Œã¯è¡Œãƒ™ã‚¯ãƒˆãƒ«${\vb*{x}_i}^{\mathsf{T}} = \qty[1,{x_i},{x_i}^2,\ldots,{x_i}^{n}]$ã‚’ç¸¦ã«ä¸¦ã¹ãŸè¡Œåˆ—
$$X=\mqty[ {\vb*{x}_1}^{\mathsf{T}} \\ {\vb*{x}_1}^{\mathsf{T}} \\ \vdots \\ {\vb*{x}_{m}}^{\mathsf{T}}]=\mqty[ 1 & x_1 & {x_1}^2 & \ldots & {x_1}^{n} \\ 1 & x_2 & {x_2}^2 & \ldots & {x_2}^{n} \\ & & \vdots & &  \\1 & x_{m} & {x_{m}}^2 & \ldots & {x_{m}}^{n} ]$$
ã‚’ç”¨ã„ã¦$\hat{\vb*{y}}=X \vb*{w}$ã¨ã‹ã‘ã‚‹ã€‚ãŸã ã—ã“ã®$X$ã¯$m\times\qty(n+1)$ã®è¡Œåˆ—ã§ã‚ã‚‹ã€‚å¹³å‡äºŒä¹—èª¤å·®$\mathrm{MSE}\qty(\vb*{w})$ã‚’è¡Œåˆ—ã§è¡¨ç¾ã—ã¦å±•é–‹ã™ã‚‹ã¨
\begin{eqnarray*}
\mathrm{MSE}\qty(\vb*{w}) &=& \frac{1}{m} \sum_{i=1}^{m} \qty(\hat{y}_i - y_i)^2=\frac{1}{m} \norm{\hat{\vb*{y}} - \vb*{y}}_2^2 = \frac{1}{m} \norm{X\vb*{w}-\vb*{y}}_2^2 \\
&=& \frac{1}{m} \qty(X\vb*{w}-\vb*{y})^\mathsf{T} \qty(X\vb*{w}-\vb*{y}) = \frac{1}{m} \qty(\vb*{w}^\mathsf{T} X^\mathsf{T} - \vb*{y}^\mathsf{T}) \qty(X\vb*{w}-\vb*{y}) \\
&=& \frac{1}{m} \qty( \vb*{w}^\mathsf{T} X^\mathsf{T} X \vb*{w}- \vb*{y}^\mathsf{T} X \vb*{w} - \vb*{w}^\mathsf{T} X^\mathsf{T} \vb*{y} +\vb*{y}^\mathsf{T} \vb*{y} )
\end{eqnarray*}
ã¨ãªã‚‹ã€‚ãŸã ã—$\vb*{y}=\qty[y_1,\ldots,y_m]^\mathsf{T}$ã¨ã—ãŸã€‚ç›®ä¸‹ã®ç›®çš„ã¯å¹³å‡äºŒä¹—èª¤å·®$\mathrm{MSE}\qty(\vb*{w})$ã‚’æœ€å°åŒ–ã™ã‚‹$\vb*{w}$ã‚’æ±‚ã‚ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚è¡Œåˆ—ã®å¾®åˆ†ã®å…¬å¼
$$\pdv{\vb*{w}}\qty(\vb*{w}^\mathsf{T} D \vb*{w})=\qty(D+D^\mathsf{T})\vb*{w},~~~\pdv{\vb*{w}}\qty(\vb*{a}^\mathsf{T} \vb*{w})=\pdv{\vb*{w}}\qty(\vb*{w}^\mathsf{T} \vb*{a})=\vb*{a}$$
ã‚’ç”¨ã„ã¦å¹³å‡äºŒä¹—èª¤å·®$\mathrm{MSE}\qty(\vb*{w})$ã‚’å¾®åˆ†ã™ã‚‹ã¨
$$\pdv{\mathrm{MSE}\qty(\vb*{w})}{\vb*{w}} = \frac{2}{m} \qty(X^\mathsf{T} X  \vb*{w} - X^\mathsf{T} \vb*{y})$$
ã¨ãªã‚‹ã®ã§ã€ã“ã‚ŒãŒ$\vb*{0}$ã¨ãªã‚‹ã®ã¯$\vb*{w}=\qty(X^\mathsf{T} X)^{-1} X^\mathsf{T} \vb*{y}$ã®ã¨ãã§ã‚ã‚‹ã€‚\\


ã¤ãã«å¹³å‡äºŒä¹—èª¤å·®$\mathrm{MSE}\qty(\vb*{w})$ã‚’æœ€å°åŒ–ã™ã‚‹ã®ã§ã¯ãªãã€é‡ã¿æ¸›è¡°$\lambda\norm{\vb*{w}}_2^2=\lambda \vb*{w}^\T \vb*{w}$ã‚’åŠ ãˆãŸã‚‚ã®$J(\vb*{w})=\mathrm{MSE}\qty(\vb*{w}) + \lambda \vb*{w}^\T \vb*{w}$ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã‚‹ã€‚$\pdv*{(\vb*{w}^\T \vb*{w})}{\vb*{w}}=2\vb*{w}$ã‚ˆã‚Š
$$\pdv{J(\vb*{w})}{\vb*{w}}=\pdv{\mathrm{MSE}(\vb*{w})}{\vb*{w}}+\pdv{\qty(\lambda \vb*{w}^\T \vb*{w} )}{\vb*{w}}= \frac{2}{m} \qty(X^\mathsf{T} X \vb*{w} - X^\mathsf{T} \vb*{y}) + 2\lambda \vb*{w},$$
ã—ãŸãŒã£ã¦ã“ã‚ŒãŒ$\vb*{0}$ã¨ãªã‚‹ã®ã¯
$\vb*{w}=\qty(X^\mathsf{T} X +m \lambda I)^{-1} X^\mathsf{T} \vb*{y}$
ã®ã¨ãã§ã‚ã‚‹ã€‚\\

ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãã«ã‚ãŸã£ã¦è¨˜å·ã‚’ã„ã‚ã„ã‚å®šç¾©ã™ã‚‹ã€‚$A:=X^\T X,~B:=A+m\lambda I,~\vb*{v}:=X^\T\vb*{y}$ã¨ãŠãã€‚ã™ã‚‹ã¨ç›®çš„ã¯$(n+1)$æœ¬ã®1æ¬¡é€£ç«‹æ–¹ç¨‹å¼$B\vb*{w}=\vb*{v}$ã‚’$\vb*{w}$ã«ã¤ã„ã¦è§£ãã“ã¨ã«å¸°ç€ã•ã‚Œã‚‹ã€‚ã“ã®ç›®çš„ã¯ã€ã•ã‚‰ã«æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—$C:=\mqty[B&\vb*{v}]$ã«ã‚¬ã‚¦ã‚¹ã®æƒãå‡ºã—æ³•ã‚’è¡Œã†ã“ã¨ã«å¸°ç€ã•ã‚Œã‚‹ã€‚
ãŸã ã—
$$X^\T = \mqty[1 & 1 & \cdots &1 \\ x_1 & x_2 & \cdots & x_m \\ {x_1}^2 & {x_2}^2 & \cdots & {x_m}^2 \\ \vdots & \vdots & & \vdots \\ {x_1}^n & {x_2}^n & \cdots & {x_m}^n],~~~X=\mqty[ 1 & x_1 & {x_1}^2 & \ldots & {x_1}^{n} \\ 1 & x_2 & {x_2}^2 & \ldots & {x_2}^{n} \\ & & \vdots & &  \\1 & x_{m} & {x_{m}}^2 & \ldots & {x_{m}}^{n} ]$$
ã‚ˆã‚Š$A$ã®æˆåˆ†ã‚’å…·ä½“çš„ã«æ›¸ãã¨
$$A=X^\T X = \mqty[ s_0 & s_1 & s_2 & \cdots & s_m \\ s_1 & s_2 & s_3 & \cdots & s_{n+1} \\ s_2 & s_3 & \cdots & \cdots & s_{n+2}  \\ \vdots & \vdots & \ddots & \ddots & \vdots \\ s_n & s_{n+1} & s_{n+2} & \cdots & s_{n+n}],~~~~s_k=\sum_{i=1}^{m} {x_i}^k,~~~~k=0,\ldots,2n$$
ã¨ãªã‚‹ã€‚ã¤ã¾ã‚Š$A$ã¯å¯¾è§’ç·šã«å‚ç›´ãªæ–¹å‘ã®æˆåˆ†ãŒã™ã¹ã¦åŒã˜ã§ã‚ã‚‹ã‚ˆã†ãªã€$(n+1)$æ¬¡ã®å¯¾è§’è¡Œåˆ—ã«ãªã£ã¦ã„ã‚‹ã€‚ãã®æˆåˆ†ã¯$a_{ij}=s_{i+j-2},~i,j=1,\ldots,n+1$ã¨å®šå¼åŒ–ã§ãã‚‹ã€‚$B$ã¯ãã®å¯¾è§’æˆåˆ†ã«$m\lambda$ã‚’åŠ ãˆãŸè¡Œåˆ—ã§ã‚ã‚‹ã€‚ãŸã ã—$\lambda$ã¯ä»»æ„ã®å¤‰æ•°ã§ã‚ã‚‹ã‹ã‚‰ã€$m\lambda$ã§ã¯ãªãå˜ã«$\lambda$ã‚’åŠ ãˆã‚‹ã“ã¨ã«ã™ã‚‹ã€‚
$$b_{ij}=\left\{\begin{array}{ll}{a_{ij}+ \lambda,} & {\mathrm{if}~i=j,} \\ {a_{ij},} & {\mathrm{if}~i\neq j.}\end{array}\right.$$
ã•ã‚‰ã«$\vb*{v}$ã‚’å…·ä½“çš„ã«ç¤ºã™ã¨
$$\vb*{v}=X^\T \vb*{y} = \mqty[1 & 1 & \cdots &1 \\ x_1 & x_2 & \cdots & x_m \\ {x_1}^2 & {x_2}^2 & \cdots & {x_m}^2 \\ \vdots & \vdots & & \vdots \\ {x_1}^n & {x_2}^n & \cdots & {x_m}^n] \mqty[y_1 \\ y_2 \\ \vdots \\ y_m ] = \mqty[ v_0 \\ v_1 \\ \vdots \\ v_{n}],~~~~v_l = \sum_{i=1}^{m} {x_i}^{l} y_i,~~~~l=0,\ldots,n$$
ã§ã‚ã‚‹ã€‚æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—$C$ã¯
\begin{equation}
C=\mqty[B & \vb*{v}]=\mqty[ b_{11} & b_{21} & \cdots & b_{n+1,1} & v_0 \\ b_{12} & \ddots & & \vdots & v_1 \\ \vdots & & \ddots & \vdots & \vdots \\ b_{1, n+1} & \cdots & \cdots & b_{n+1, n+1} & v_n] \label{C}
\end{equation}
ã‚ˆã‚Šãã®æˆåˆ†$c_{ij},~i=1,\ldots,n+1,~ j=1,\ldots,n+2$ã¯
$$c_{ij}=\left\{\begin{array}{ll}{b_{ij},} & {\mathrm{for}~i,j=1,\ldots,n+1,} \\ {v_{i-1},} & {\mathrm{for}~i=1,\ldots,n+1,~j=n+2}\end{array}\right.$$
ã¨ã‹ã‘ã‚‹ã€‚ã“ã‚Œã¯$(n+1)\times(n+2)$ã®è¡Œåˆ—ã«ãªã‚‹ã€‚

\section{å®Ÿé¨“æ–¹æ³•ã¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰}
ã¾ãšãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã€æ¨å®šã—ãŸã„å¤šé …å¼ã®ä¿‚æ•°$\vb*{w} = \qty[w_0,\ldots,w_n]^\T$ã¨ã€æ¨å®šæ›²ç·šã®$(x,y)$ã®å€¤ã‚’å‡ºåŠ›ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ãŸã€‚ãã‚Œã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰\ref{ridge}ã«ç¤ºã™ã€‚$\vb*{w} = \qty[w_0,\ldots,w_n]^\T$ã‚’æ±‚ã‚ã‚‹ã®ã«ã¯ã€å¼(\ref{C})ã®æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—$C$ã«ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•ã‚’é©ç”¨ã—ãŸã€‚ãƒ‡ãƒ¼ã‚¿ã®æ•°$m,~$å¤šé …å¼ã®æ¬¡æ•°$n,~$æ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿$\lambda,~$ãƒ—ãƒ­ãƒƒãƒˆã®åˆ†å‰²å¹…ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä½œæˆè€…ãŒå…¥åŠ›ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã€‚$m$å€‹ã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¯ã€åŒºé–“$[0,2)$ã®ä¸€æ§˜ä¹±æ•°ã‚’é–¢æ•°$2\cos\qty(2x)+x$ã«è¶³ã™ã“ã¨ã§ç”Ÿæˆã—ãŸã€‚ãã‚Œã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰\ref{data_generator}ã«ç¤ºã™ã€‚

æ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’$\lambda = 10^4,~10^2,~10^0,~10^{-2},~10^{-4},~0$ã¨ã—ãŸã¨ãã«ã€$m=30$å€‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’$n=10,~20,~30$æ¬¡ã®å¤šé …å¼ã§æ¨å®šã—ãŸã€‚

\begin{lstlisting}[caption=ãƒªãƒƒã‚¸å›å¸°ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰,label=ridge]
program ridge_regression
 implicit none

 real(8), allocatable :: x(:), y(:), data(:), s(:), v(:)
 real(8), allocatable :: a(:, :), b(:, :), c(:, :), w(:)
 real(8) :: lambda, p, q, width, delta, xmin, y_hat, x1
 integer :: i, j, n, m, k, l, i1, i2

 ! ***å…¥åŠ›*********************
   ! ãƒ‡ãƒ¼ã‚¿ã®æ•°
   m = 30

   ! è¿‘ä¼¼ã—ãŸã„æ›²ç·šã®æ¬¡æ•°
   n = 10

   ! æ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
   lambda = 1.0_8

 !***ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿***********************
  allocate(x(m), y(m), data(2 * m))
  ! mx2ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆã€Œdata.txtã€ãªã©ï¼‰ã‚’ã‚µã‚¤ã‚º2mã®é…åˆ—data(2*m)ã¨ã—ã¦èª­ã¿è¾¼ã‚€ã€‚
  ! ï¼ˆã€Œ./a.out < data.txtã€ ï¼‰
  ! data(2*m)ã¯x,y,x,y,â€¦ã®ã‚ˆã†ãªä¸¦ã³ã«ãªã£ã¦ã„ã‚‹ã€‚

  read(*,*) data

  ! data(2*m)ã®å¥‡æ•°ç•ªç›®ã‚’x(j), å¶æ•°ç•ªç›®ã‚’y(j)ã¨ã™ã‚‹ã€‚
  do i = 1, 2*m
    if ( mod(i, 2) == 0 ) then
      j = i / 2
      y(j) = data(i)
    else if ( mod(i, 2) == 1 ) then
      j = (i + 1) / 2
      x(j) = data(i)
    end if
  end do

! ç¢ºèªæ¸ˆã¿
! do j = 1, m
!  write(*,*) j, x(j), y(j)
! end do

!***æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—ã®æº–å‚™***********************************
! è§£ããŸã„é€£ç«‹æ–¹ç¨‹å¼Bw=vã®Bã¨vã®æˆåˆ†ã‚’è¨ˆç®—ã—ã¦ãŠãã€‚
! æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—C=[B v]ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
  allocate(s(0:2 * n), a(n + 1, n + 1), b(n + 1, n + 1), v(0 : n), c(n + 1,  n + 2))

! s_k = sum_{i=1}^{m} {x_i}^k, k=0~2nã®è¨ˆç®—
  do k = 0, 2 * n
    s(k) = 0.0_8
    do i = 1, m
      s(k) = s(k) + (x(i)) ** (real(k))
    end do
!    write(*,*) k, s(k)
  end do

  ! è¡Œåˆ—Aã®è¨ˆç®—ã€‚ãã®æˆåˆ†ã¯a_{ij}=s_{i+j-2}, i,j=1~n+1.
  do j = 1, n + 1
    do i = 1, n + 1
      a(i, j) = s(i + j - 2)
  !    write(*,*) i, j, i + j - 2, s(i + j - 2), a(i, j)  ! ç¢ºèªæ¸ˆã¿
    end do
  end do

  ! è¡Œåˆ—Bã®è¨ˆç®—ã€‚è¡Œåˆ—Aã®å¯¾è§’æˆåˆ†ã«lambdaã‚’è¶³ã™ã ã‘ã€‚
  do j = 1, n + 1
    do i = 1, n + 1
      if ( i == j ) then
        b(i, j) = a(i, j) + lambda
      else if ( i /= j ) then
        b(i, j) = a(i, j)
      end if
!      write(*,*) i, j, b(i, j) - a(i, j) ! ç¢ºèªæ¸ˆã¿ã€‚
    end do
  end do

! v_l = sum_{i=1}^{m} y_i {x_i}^l, l=0~nã®è¨ˆç®—
   do l = 0, n
     v(l) = 0.0_8
     do i = 1, m
       v(l) = v(l) + y(i) * (x(i)) ** real(l)
     end do
!     write(*,*) l, v(l) ! ç¢ºèªæ¸ˆã¿
   end do

! æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—C=[B v]ã‚’ä½œã‚‹
  do i = 0, n
    do j = 1, n + 2
      if (j == n + 2) then
        c(i + 1, j) = v(i)
      else if (j /= n + 2) then
        c(i + 1, j) = b(i + 1, j)
      end if
    end do
  end do
!   ç¢ºèªæ¸ˆã¿
!  do i = 0, n
!    do j = 1, n + 2
!      write(*,*) i + 1, j, v(i), c(i + 1, j)
!    end do
!  end do

! ***ã‚¬ã‚¦ã‚¹ã®æƒãå‡ºã—æ³•**************************************
! ä¸Šã§ä½œã£ãŸ(n+1)x(n+2)ã®æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—Cã«ã‚¬ã‚¦ã‚¹ã®æƒãå‡ºã—æ³•ã‚’é©ç”¨ã™ã‚‹ã€‚
! ã‚ã‚‹kè¡Œç›®ã®å¯¾è§’æˆåˆ†c(k,k)ã‚’pã¨ãŠãã€ãã®è¡Œã™ã¹ã¦ã‚’pã§å‰²ã‚‹ã€‚
! ãã†ã™ã‚Œã°ãã®å¯¾è§’æˆåˆ†c(k,k)ã¯1ã«ãªã‚‹ã€‚
! kè¡Œç›®ä»¥å¤–ã®è¡Œã«ã¤ã„ã¦ï¼ˆã“ã‚Œã‚’iè¡Œç›®ã¨ã™ã‚‹ï¼‰ã€c(k,k)ã¨åŒã˜åˆ—ã«ã‚ã‚‹ã‚‚ã®(c(i,k))ã‚’qã¨ãŠãã€‚
! ãã®iè¡Œç›®ã®kåˆ—ç›®ä»¥é™ã®æˆåˆ†c(i,j), j=k~n+2 ã‹ã‚‰q*c(k,j)ã‚’å¼•ãã€‚
! ã“ã‚Œã§c(k,k)ã®ä¸Šä¸‹ã¯ã‚¼ãƒ­ã«ãªã‚‹ã€‚
! ã“ã®ã“ã¨ã‚’ã™ã¹ã¦ã®è¡Œ k=1~n+1 ã«ã¤ã„ã¦è¡Œã†ã€‚

  do k = 1, n + 1
    p = c(k, k)
    do j = k, n + 2
      c(k, j) = c(k, j) / p
    end do
    do i = 1, n + 1
      if (i /= k) then
        q = c(i, k)
        do j = k, n + 2
          c(i, j) = c(i, j) - q * c(k, j)
        end do
      end if
    end do
  end do

!   ç¢ºèªæ¸ˆã¿
!   do i = 1, n + 1
!     do j = 1, n + 2
!       write(*,*) i, j, c(i, j)
!     end do
!   end do

! ã“ã†ã—ã¦å¾—ã‚‰ã‚ŒãŸè¡Œåˆ—ã®æœ€å¾Œã®åˆ—c(i,n+2), i=1~n+1ãŒwã®è§£ã§ã‚ã‚‹ã€‚
  allocate(w(n + 1))
    do i = 1, n + 1
      w(i) = c(i, n + 2)
      write(*,*)  i - 1, w(i) ! ç¢ºèªæ¸ˆã¿
    end do

! ***æ›²ç·šã®ãƒ—ãƒ­ãƒƒãƒˆ****************************************
! åˆ†å‰²æ•°
  i1 = 200

! xã®å¹…widthã¨xã®æœ€å°å€¤xminã‚’è¨ˆç®—ã€‚
  width = maxval(x) - minval(x)
  xmin = minval(x)
!    write(*,*) width, xmin, maxval(x) ! ç¢ºèªæ¸ˆã¿

  ! æ›²ç·šã®ãƒ—ãƒ­ãƒƒãƒˆã®åˆ»ã¿å¹…
  delta = width / real( i1 )

  open (18, file='line.txt', status='replace')
  do i2 = 0, i1
    y_hat = 0.0_8
    x1 = xmin + real(i2) * delta
      do i = 1, n + 1
        y_hat = y_hat + w(i) * x1 ** (real(i - 1))
      end do
    write(18, *) x1, y_hat ! ã“ã“ã§xã«å¯¾ã™ã‚‹è¿‘ä¼¼æ›²ç·šy_hat=sum_{k=0}^{n} w_k x^kã®å€¤ã‚’å‡ºåŠ›
  end do
  close(18)

  deallocate(x, y, data, s, v, a, b, c, w)

 stop
end program
\end{lstlisting}

\begin{lstlisting}[caption=ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã®ãŸã‚ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ,label=data_generator]
program data_generator
 implicit none

 integer :: m, imax, i
 real(8) :: xmin, xmax, width, delta, x, y
 real(8), allocatable :: random(:)


! ãƒ‡ãƒ¼ã‚¿ã®å€‹æ•°
  m = 30

  allocate(random(m + 1))
  call random_number(random)
  ! ç¢ºèª
!  do i = 0, m
!   write(*,*) i, 2.0_8 * random(i + 1)
!  end do

! ãƒ‡ãƒ¼ã‚¿ã®æœ€å°å€¤ãƒ»æœ€å¤§å€¤ã®è¨­å®šã€å¹…ã€åˆ†å‰²å¹…
  xmin = 0.0_8
  xmax = 6.0_8
  width = xmax - xmin
  delta = width / real(m)
!  write(*,*) width

  open(18, file='generated_data.txt', status='replace')
  do i = 0, m - 1
    x = xmin + delta * real(i)
    y = 2.0_8 * cos(2.0_8 * x) + x  + 2.0_8 * random(i + 1)
    write(18,*) x, y
  end do
  close(18)

  deallocate(random)
  
  stop
 end program
\end{lstlisting}


\section{å‡ºåŠ›çµæœ}
$n=10,~20,~30$ã«å¯¾ã—ã¦æ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’$\lambda = 10^4,~10^2,~10^0,~10^{-2},~10^{-4},~0$ã¨ã—ãŸã¨ãã®æ¨å®šçµæœã‚’å›³\ref{10_big}ã‹ã‚‰å›³\ref{30_small}ã«ç¤ºã™ã€‚ä¸ãˆãŸ30å€‹ã®ãƒ‡ãƒ¼ã‚¿ã¯ç‚¹ã§è¡¨ã—ã€æ¨å®šã—ãŸæ›²ç·šã‚’å®Ÿç·šã§è¡¨ã—ã¦ã„ã‚‹ã€‚ãŸã ã—æ¨å®šã—ãŸæ›²ç·šã¯$200$å€‹ã®ç‚¹ã‚’ç·šã§ç¹‹ã„ã ã‚‚ã®ãªã®ã§ã€é‹­ã„ãƒ”ãƒ¼ã‚¯ãŒã‚ã‚‹ã¨ãã‚ŒãŒå‰Šã‚Œã¦ã„è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

$n=10$ãªã©$n$ãŒæ¯”è¼ƒçš„å°ã•ã„ã¨ãã€$\lambda$ã®å€¤ãŒå¤§ãã„ã¨ãã¡ã‚“ã¨ãƒ‡ãƒ¼ã‚¿ç‚¹ã‚’æ¨å®šã—ã¦ãŠã‚‰ãšã€éå°‘é©åˆã‚’ãŠã“ã—ã¦ã„ã‚‹ã®ãŒè¦³å¯Ÿã§ãã‚‹ã€‚é€†ã«$n=30$ãªã©$n$ãŒå¤§ãã$\lambda$ãŒå°ã•ã„ã¨ãã«ã¯éå‰°é©åˆã‚’èµ·ã“ã—ã¦ã„ã‚‹ã€‚

$n=30,~\lambda = 10^2$ã®ã¨ãã®æ¨å®šæ›²ç·šãŒéå‰°ã«æŒ¯å‹•ã—ã¦ã„ã‚‹ã€‚$\lambda$ã®å€¤ã‚’å°‘ã—å¤‰ãˆã¦$\lambda=99,101$ã¨ã—ã¦æ¯”è¼ƒã—ãŸãŒã€ãã®ã‚ˆã†ãªã“ã¨ã¯èµ·ã“ã£ã¦ã„ãªã‹ã£ãŸï¼ˆå›³\ref{99100101}ï¼‰ã€‚ãªãœãã†ãªã‚‹ã®ã‹ã¯ã‚ˆãã‚ã‹ã‚‰ãªã„ã€‚ã€€ã€€ã€€



%2æšã®å›³
\begin{figure}[htbp]
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{10_big.eps}
  \end{center}
  \caption{$n=10,~\lambda = 10^4,10^2,~0^0$}
  \label{10_big}
 \end{minipage}
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{10_small.eps}
  \end{center}
  \caption{$n=10,~\lambda = 10^{-2},10^{-4},0$}
  \label{10_small}
 \end{minipage}
\end{figure}

%2æšã®å›³
\begin{figure}[htbp]
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{20_big.eps}
  \end{center}
  \caption{$n=20,~\lambda = 10^4,10^2,10^0$}
  \label{}
 \end{minipage}
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{20_small.eps}
  \end{center}
  \caption{$n=20,~\lambda = 10^{-2},10^{-4},0$}
  \label{}
 \end{minipage}
\end{figure}

%2æšã®å›³
\begin{figure}[htbp]
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{30_big.eps}
  \end{center}
  \caption{$n=30,~\lambda = 10^4,10^2,10^0$}
  \label{}
 \end{minipage}
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{30_small.eps}
  \end{center}
  \caption{$n=30,~\lambda = 10^{-2},10^{-4},0$}
  \label{30_small}
 \end{minipage}
\end{figure}

%ï¼‘æšã®ç”»åƒ
\begin{figure}[htbp]
\centering 
\includegraphics[width=120mm]{99100101.eps}
\caption{$n=30$ã®ã¨ãã«$\lambda = 99,100,101$ã‚’æ¯”è¼ƒã—ãŸã‚‚ã®}
\label{99100101}
\end{figure}


\section{ä»Šå¾Œã®èª²é¡Œ}
ãªãœ$n=30,~\lambda = 10^2$ã®ã¨ãã«ç•°å¸¸ãªå‡ºåŠ›ã‚’å¾—ãŸã®ã‹ã‚’è§£æ±ºã—ãŸã„ã€‚

ã¾ãŸé©åˆ‡ãª$n$ã¨$\lambda$ã‚’ã©ã†æ±ºã‚ã‚‹ã®ã‹ã‚ã‹ã‚‰ãªã‹ã£ãŸã€‚ãã“ã§$n$ã¨$\lambda$ã‚’å°‘ã—ã¥ã¤å¤‰ãˆã¦å‡ºåŠ›ã•ã›ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä¸ãˆã¦æ±åŒ–èª¤å·®ãŒä¸€ç•ªå°ã•ã„$n$ã¨$\lambda$ã‚’é©åˆ‡ãªã‚‚ã®ã¨ã™ã‚‹ã€ã¨ã„ã†ã‚ˆã†ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚‚æ›¸ã‘ã‚‹ã ã‚ã†ã€‚






%\begin{thebibliography}{9}
%  \bibitem{é€²åŒ–è«–çš„è¨ˆç®—æ‰‹æ³•} ä¼Šè—¤æ–‰å¿—ï¼Œã€Œé€²åŒ–è«–çš„è¨ˆç®—æ‰‹æ³•ã€ï¼Œ2005å¹´ï¼pp. 107--122.
%\end{thebibliography}

\end{document}